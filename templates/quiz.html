<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AptitudePro - Level {{ question.level }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .progress-container {
            width: 100%;
            background-color: #eee;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .progress-bar {
            height: 8px;
            background-color: var(--primary-color);
            border-radius: 10px;

            width: {
                    {
                    (q_num / total_qs) * 100
                }
            }

            %;
            transition: width 0.3s ease;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="quiz-header">
            <span>Student: <strong>{{ username }}</strong></span>
            <span>Question {{ q_num }} of {{ total_qs }}</span>
        </div>

        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>

        <div class="level-tag">Level {{ question.level }}</div>

        <form action="{{ url_for('submit_answer') }}" method="POST" id="quizForm">
            <div class="question-box">
                <p class="question-text">{{ question.question }}</p>

                <div class="options-list">
                    {% for option in question.options %}
                    <label class="option-item">
                        <input type="radio" name="answer" value="{{ option }}" required>
                        <span>{{ option }}</span>
                    </label>
                    {% endfor %}
                </div>
            </div>

            <button type="submit" class="btn" id="submitBtn">Submit & Next</button>
        </form>
    </div>

    <script>
        // Option highlighting
        const options = document.querySelectorAll('.option-item');
        options.forEach(option => {
            option.addEventListener('click', () => {
                options.forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
            });
        });

        // Simple validation to prevent double submission
        document.getElementById('quizForm').onsubmit = function () {
            const selected = document.querySelector('input[name="answer"]:checked');
            if (!selected) {
                alert("Please select an answer!");
                return false;
            }
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('submitBtn').innerText = "Loading Next...";
        };
    </script>
</body>

</html>